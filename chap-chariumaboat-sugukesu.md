# すぐ消すbotについて

<div class="flushright">すぐ消すbotについて</div>

すぐ消すbotとは何か。T氏が初めてPythonで作成し、ガレソに取り上げられ、はちま起稿に記事となった原体験のことである。

![ガレソ](images/chap-chariumaboat-sugukesu/gareso.png?scale=0.5)

![はちま](images/chap-chariumaboat-sugukesu/hatima.png?scale=0.5)

T氏は何故これを作ったのか、これを作って何があったのか、T氏しか知り得ないのでヒアリングした。その結果を今ここに記す。

## 企画
K氏という発端の人物がいる。彼が**女装ホモセックスした二人の男性カップルがニチニチした様子をTwitterに投稿→羞恥心で削除→リカバリープラン発動→救済**という企画を行った。Tしは女装した男性が愛し合い、**果て**に行ってしまう動画が好きだ。これについてツイートをしていたらK氏がリプライをしてきた。確かにLGBTが絡み、センシティブな話題であるため、ネットから情報がなくなってしまうことが多い。

T氏はこれを救いたかった、当時T氏はコロナ禍でとてつもなく暇だったため、プログラミングを勉強していた。一番最初に作ったプログラムは僕ヤバという漫画が火曜日に更新されるのだが、面白くもない漫画を面白くない人間たちが火曜日の正午に面白くないコメントを大量に行い、Twitterを埋め尽くすのが本当に嫌だった。本音をいうと自分がついていけていないというのが嫌だった。

これに対してDXを行った。Tweepyで「僕ヤバ　ヤバイ」と検索し、最もいいねが多い発言を自分のツイートとして転載するというものだった。これによってTは昼まで食い込むミーティングがあったとしても、インターネットでは流行にノっている人間としてブランディングすることができた。わずか13行のAWS Lambdaによっておじさんがトレンドに食い込むことができる体験は神託に近かった。これを応用した。

## 要件定義・プロトタイピング・検証
すぐ消される画像をキャッチアップするにはどうしたらいいのか。「すぐ消す」「後で消す」と書かれたツイートを検索し、同時に投稿されている画像や動画を保存してみることにした。最初はローカルで行っていたのだが、定期的にスクリプトを実行するのが手間だったので、サーバーを建てようとした。こんなくだらないものにお金をかけたくなかったので、無料のGCPを選択した。

1ヶ月ほど運用した結果、ネットワークの課金が百円程度発生した。これに対して怒りしか覚えなかった。インスタンスとボリュームは無料なのだが、アウトバウンド通信は許容を超えると従量課金になることに気がついた。T氏はこれに対してキャッチアッププランを発動し、Oracle Cloudにすることにした。

検証の結果インフラはこうなった。

| 項目 | GCP | Oracle Cloud |
| -------- | -------- | -------- |
| インスタンス | apacheでメモリカツカツになるカスインスタンスが月1台無料| apacheとpostgresがギリ動くインスタンス2台とモンスターインスタンス1台が無料|
| ネットワーク| 使いはじめは無料、ある程度使うと料金発生| ずっとタダ |

こう見ると、GCPはゴミカスであることがわかる。商用であればOracle Cloudは学習コストが高いので問答無用で却下するが、個人開発でタダなら最高の環境である。

またGCPではS3のパチモンが5GB無料であるが、Oracle Cloudでは10GB無料であった。どちらもS3互換APIが使えるので、くだらないファイルを置いてステートレスにしたい場合かなり有効である。

## 設計
すぐ消すと書かれた画像及び動画を定期的に保存する。

### インフラ
前述の通りOracle Cloudのコンピュートを使用する。cronで動かす。

### アプリ
tweepyが素晴らしいライブラリであるので、これを使用し、Pythonで動かす。

## 運用
わざわざ画像を取り出して閲覧するのがめんどくさかったので、Twitterで別アカウントを作り、そこに転載することにした。
TwitterというSaaSは画像・動画に関して凍結されるまでの間であるが、無尽蔵に蓄積することができる。取り出しもAPI経由であれば3200件まで無料であるし、最高の環境だった。

## 炎上
物好きのフォロワーが転載アカウントをフォローし始め、フォロワーが100を超えたあたりで、フォロワーが多い友達に紹介をしてもらった。そうした結果、1日でフォロワーが1000人増えてしまい、いわゆる炎上状態になってしまった。正直飽きていたので、世間がこういう悪いものをどう受け取るのか気になっていたのでいい兆候であった。