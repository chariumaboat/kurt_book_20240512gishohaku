# すぐ消すbotについて

<div class="flushright">すぐ消すbotについて</div>

すぐ消すbotとは何か。T氏が初めてPythonで作成し、ガレソに取り上げられ、はちま起稿に記事となった原体験のことである。

![ガレソ](images/chap-chariumaboat-sugukesu/gareso.png?scale=0.5)

![はちま](images/chap-chariumaboat-sugukesu/hatima.png?scale=0.5)

T氏は何故これを作ったのか、これを作って何があったのか、T氏しか知り得ないのでヒアリングした。その結果を今ここに記す。

## 企画
K氏という発端の人物がいる。彼が**女装ホモセックスした二人の男性カップルがニチニチした様子をTwitterに投稿→羞恥心で削除→リカバリープラン発動→救済**という企画を行った。T氏は女装した男性が愛し合い、**果て**に行ってしまう動画が好きだ。これについてツイートをしていたらK氏がリプライをしていた。確かにLGBTが絡み、センシティブな話題であるため、ネットから情報がなくなってしまうことが多い。

T氏はこれを救いたかった、当時T氏はコロナ禍でとてつもなく暇だったため、プログラミングを勉強していた。一番最初に作ったプログラムは僕ヤバという漫画が火曜日に更新されるのだが、面白くもない漫画を面白くない人間たちが火曜日の正午に面白くないコメントを大量に行い、Twitterを埋め尽くすのが本当に嫌だった。本音をいうと自分がついていけていないというのが嫌だったらしい。

これに対して彼はDXを行った。Tweepyで「僕ヤバ　ヤバイ」と検索し、最もいいねが多い発言を自分のツイートとして転載するというものだった。これによってT氏は昼まで食い込むミーティングがあったとしても、インターネットでは流行にノっている人間としてブランディングすることができた。わずか13行のAWS Lambdaによっておじさんがトレンドに食い込むことができる体験は神託に近かった。これを応用した。

## 要件定義・プロトタイピング・検証
すぐ消される画像をキャッチアップするにはどうしたらいいのか。「すぐ消す」「後で消す」と書かれたツイートを検索し、同時に投稿されている画像や動画を保存することだった。最初はローカルで行っていたのだが、定期的にスクリプトを実行するのが手間だったので、サーバーを建てようとした。こんなくだらないものにお金をかけたくなかったので、無料のGCPを選択した。

1ヶ月ほど運用した結果、ネットワークの課金が百円程度発生した。これに対して怒りしか覚えなかった。インスタンスとボリュームは無料なのだが、アウトバウンド通信は許容を超えると従量課金になることに気がついた。T氏はこれに対してキャッチアッププランを発動し、Oracle Cloudにすることにした。

検証の結果インフラはこうなった。

| 項目 | GCP | Oracle Cloud |
| -------- | -------- | -------- |
| インスタンス | カスインスタンスが月1台無料| インスタンス2台が無料|
| ネットワーク| ある程度使うと料金発生| ずっとタダ |

こう見ると、GCPはゴミカスであることがわかる。商用であればOracle Cloudは学習コストが高いので問答無用で却下するが、個人開発でタダなら最高の環境である。

またGCPではS3のパチモンが5GB無料であるが、Oracle Cloudでは10GB無料であった。どちらもS3互換APIが使えるので、くだらないファイルを置いてステートレスにしたい場合かなり有効である。

## 設計
すぐ消すと書かれた画像及び動画を定期的に保存する。

### インフラ
前述の通りOracle Cloudのコンピュートを使用する。cronで動かす。

### アプリというかバッチ
tweepyという素晴らしいライブラリであるので、これを使用し、Pythonで動かす。

## 運用
インスタンスに画像を溜めた結果、わざわざ画像を取り出して閲覧するのがめんどくさかったので、Twitterで別アカウントを作り、そこに転載することにした。
TwitterというSaaSは画像・動画に関して凍結されるまでの間であるが、無尽蔵に蓄積することができる。取り出しもAPI経由であれば3200件まで無料であるし、最高の環境だった。

## 炎上
物好きのフォロワーが転載アカウントをフォローし始め、フォロワーが100を超えたあたりで、起爆剤としてフォロワーが多い友達に紹介をしてもらった。そうした結果、1日でフォロワーが1000人増えてしまい、いわゆる炎上状態になってしまった。正直飽きていたので、世間がこういう悪いものをどう受け取るのか気になっていたのでいい兆候であった。

### 承認欲求モンスターの発生
![腐女子様1](images/chap-chariumaboat-sugukesu/fujosi.jpeg?scale=0.5)
世間は突如現れたイレギュラーに対して、いかに面白い反応を取ってフォロワーを笑わせるかという動きに徹した。それが度を行き過ぎた場合、いいね・RT稼ぎのマシーンとなってしまい、上記のスクショのようになってしまう。

一人の人物をモデルとして事象を紹介したいと思う。モデルKは注意喚起ツイートがBuzzったのを気に承認欲求が暴走したのか、常にすぐ消すbotに対して反応していた。作者　(T氏)を特定しようと躍起になっていたようだが、結局できなかったようだ。検索力の無さがあまりにも悲しい。

![腐女子様2](images/chap-chariumaboat-sugukesu/fujosi2.jpeg?scale=0.5)

注意喚起ツイートがBuzzったからと自分の一次創作のグッズをぶら下げて宣伝していたが、いつもRTしてくれる人しか反応してくれず、さらに欲求が暴走したのも観測した。モデルKは最終的に全てのツイートを削除し、いつもの馴れ合いに戻っていった。今後もダボハゼのように世間の話題に噛みついていくのだろう。

ちなみにT氏はこの辺りでやる気をなくして消して会員制陰湿倶楽部「馬鹿博覧会」としてプログラムのアップデートを続けた。私はそれをゲラゲラ笑いながら見ていた。穏やかな午後であった。

![よくわからない弁明](images/chap-chariumaboat-sugukesu/fujosi3.png?scale=0.5)

インターネットに公開してこの感じは危機感がないのが心配になってしまう。T氏のメッサージュが伝わらなかったようだ。

## その後
公開を数人に絞った会員制陰湿倶楽部に格納された画像は15万を超えた。基盤はDjango＋postgresのWebサイトに始まり、apacheとDjangoの相性が悪くサイトはダウンした。めんどくさいのでT氏直さなかった。現在風の噂ではDiscordにおいて復活しているという噂がある。TwitterのAPIが死んで久しいが「とある方法」を使用することでリザレクションしたらしい。何か画像を有効活用できないだろうか。

できないだろう…。

## 技術的なアップデート
### 承認欲求の除外
腐女子様の承認欲求(どうでもいいイラスト排除)を技術的に解決したかった。まず10万件の自己紹介文を解析しようとワードクラウドを作成した。

![地獄のようなワードクラウド](images/chap-chariumaboat-sugukesu/wordcloud.jpeg?scale=0.5)

これに基づいて、トップ順位の承認欲求ワードを除外することにした。これは大いに効果があった。

- 雑多
- 創作
- 絵
- 成人(済)
### イラストの判定
写真とイラストでは使用している色が圧倒的に写真の方が多い、これを利用し使用している色が多い画像ファイルのみをピックアップするようにした。これはあまり良くなかった。紙に書いたラフ絵をスマートフォンで撮影し、Twitterにアップロードするものが弾けなかったからだ。この辺りでT氏は飽きて開発が凍結された

### DDL
具体的に以下のようにしたと聞いている。

```sql
-- 基本情報
create table info (
 	id bigint PRIMARY KEY, 
 	create_at timestamp,
 	screen_name text,
 	tweet_text text,
 	bio text,
	raw_json text,
	insert_at timestamp,
	delflag boolean,
  votescore bigint,
  uid bigint,
  post_at timestamp
);

-- 画像
create table image(
  id bigint, 
  num integer, 
  image text, 
  foreign key (id) references info(id)
);

-- FILTER VIEW
CREATE VIEW infoimage as 
SELECT info.id,
   info.create_at,
   info.screen_name,
   info.tweet_text,
   info.bio,
   image.image,
   image.num,
   info.delflag,
   image.score,
   info.votescore,
   info.uid
  FROM (info JOIN image ON ((info.id = image.id)))
  WHERE bio NOT LIKE '%成人%' 
  AND bio NOT LIKE '%絵%'
  AND bio NOT LIKE '%創作%'
  AND bio NOT LIKE '%雑多%'
  AND bio NOT LIKE '%TRPG%'
  AND bio NOT LIKE '%転載%'
  AND bio NOT LIKE '%推%'
  AND tweet_text NOT LIKE '%ラフ%'
  AND tweet_text NOT LIKE '%描%'
  AND tweet_text NOT LIKE '%下書%'
  AND score < 1;
```

## 最後に
インターネットやめるか、鍵アカウントにした方がいい。